name: Daily Telegram Parser

on:
  schedule:
    # –ó–∞–ø—É—Å–∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 03:00 UTC
    - cron: '0 3 * * *'
  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏–∑ –≤–∫–ª–∞–¥–∫–∏ "Actions"
  workflow_dispatch: 

permissions:
  contents: write # –î–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –∑–∞–ø–∏—Å—å (–∫–æ–º–º–∏—Ç –∏ –ø—É—à) —Ñ–∞–π–ª–æ–≤

jobs:
  run_parser:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4 # –°–∫–∞—á–∏–≤–∞–µ—Ç –≤–∞—à –∫–æ–¥
    
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        pip install -r requirements.txt
        # –£—Å—Ç–∞–Ω–æ–≤–∏–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ
        pip install pyrogram[speedups]
        
    - name: Run Parser Script
      # –ü–µ—Ä–µ–¥–∞–µ–º API –∫–ª—é—á–∏ –∏–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤ GitHub
      env:
        TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
        TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
      run: |
        python parcing.py
        
    - name: Commit and Push changes # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: "ü§ñ Feat: Daily update of dolls data."
        # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–ø–∫–∏ static/ –∏ backend.py –¥–æ—Å—Ç—É–ø–Ω—ã
        files: static/
